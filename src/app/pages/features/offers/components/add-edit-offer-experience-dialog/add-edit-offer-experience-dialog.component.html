<p-dialog
  [visible]="offerExperienceService.isDialogVisibleComputed()"
  (visibleChange)="offerExperienceService.setDialogVisible($event)"
  [style]="{ width: '50rem' }"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  (onHide)="onHide()"
  class="dark:bg-slate-800 overflow-visible"
>
  <ng-template pTemplate="header">
    <span class="font-medium text-text!">
      <i class="pi pi-briefcase mr-2 text-primary"></i>
      {{ (isEditMode ? "EDIT_EXPERIENCE" : "ADD_EXPERIENCE") | translate }}
    </span>
  </ng-template>

  <form [formGroup]="experienceForm" (ngSubmit)="onSave()" class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <!-- Title -->
      <div class="flex flex-col">
        <label for="title" class="text-sm font-medium text-text/85 mb-1">
          <i class="pi pi-id-card mr-2"></i>{{ "TITLE" | translate }} *
        </label>
        <input
          pInputText
          id="title"
          formControlName="title"
          class="w-full rounded-md! bg-card! text-text! px-4! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
          [class.border-red-500]="
            experienceForm.get('title')?.invalid &&
            experienceForm.get('title')?.touched
          "
        />
        <small
          *ngIf="
            experienceForm.get('title')?.invalid &&
            experienceForm.get('title')?.touched
          "
          class="text-red-500 mt-1 dark:text-red-400"
        >
          {{ "REQUIRED" | translate }}
        </small>
      </div>

      <!-- Company -->
      <div class="flex flex-col">
        <label for="company" class="text-sm font-medium text-text/85 mb-1">
          <i class="pi pi-building mr-2"></i>{{ "COMPANY" | translate }} *
        </label>
        <input
          pInputText
          id="company"
          formControlName="company"
          class="w-full rounded-md! bg-card! text-text! px-4! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
          [class.border-red-500]="
            experienceForm.get('company')?.invalid &&
            experienceForm.get('company')?.touched
          "
        />
        <small
          *ngIf="
            experienceForm.get('company')?.invalid &&
            experienceForm.get('company')?.touched
          "
          class="text-red-500 mt-1 dark:text-red-400"
        >
          {{ "REQUIRED" | translate }}
        </small>
      </div>

      <!-- Years Required -->
      <div class="flex flex-col">
        <label
          for="yearsRequired"
          class="text-sm font-medium text-text/85 mb-1"
        >
          <i class="pi pi-calendar mr-2"></i
          >{{ "YEARS_REQUIRED" | translate }} *
        </label>
        <p-inputNumber
          id="yearsRequired"
          formControlName="yearsRequired"
          class="w-full! rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
          [min]="0"
          [class.border-red-500]="
            experienceForm.get('yearsRequired')?.invalid &&
            experienceForm.get('yearsRequired')?.touched
          "
        ></p-inputNumber>

        <small
          *ngIf="
            experienceForm.get('yearsRequired')?.invalid &&
            experienceForm.get('yearsRequired')?.touched
          "
          class="text-red-500 mt-1 dark:text-red-400"
        >
          {{ "REQUIRED" | translate }}
        </small>
      </div>

      <!-- Requirement Level -->
      <div class="flex flex-col">
        <label
          for="requirementLevel"
          class="text-sm font-medium text-text/85 mb-1"
        >
          <i class="pi pi-star mr-2"></i>{{ "REQUIRED_LEVEL" | translate }} *
        </label>
        <p-select
          id="requirementLevel"
          formControlName="requirementLevel"
          [options]="requirementLevelOptions"
          optionLabel="name"
          optionValue="value"
          placeholder="{{ 'SELECT_REQUIREMENT_LEVEL' | translate }}"
          class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
          [class.border-red-500]="
            experienceForm.get('requirementLevel')?.invalid &&
            experienceForm.get('requirementLevel')?.touched
          "
        ></p-select>
        <small
          *ngIf="
            experienceForm.get('requirementLevel')?.invalid &&
            experienceForm.get('requirementLevel')?.touched
          "
          class="text-red-500 mt-1 dark:text-red-400"
        >
          {{ "REQUIRED" | translate }}
        </small>
      </div>
    </div>

    <!-- Description -->
    <div class="flex flex-col">
      <label for="description" class="text-sm font-medium text-text/85 mb-1">
        <i class="pi pi-align-left mr-2"></i>{{ "DESCRIPTION" | translate }}
      </label>
      <textarea
        pTextarea
        id="description"
        formControlName="description"
        class="w-full rounded-md! bg-card! text-text! h-full! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
        rows="5"
        [autoResize]="true"
      ></textarea>
    </div>

    <div class="flex justify-end gap-2 mt-6">
      <button
        pButton
        type="button"
        label="{{ 'CANCEL' | translate }}"
        class="p-button-text"
        (click)="onHide()"
        [disabled]="isLoading()"
      ></button>
      <button
        pButton
        type="submit"
        [label]="(isEditMode ? 'UPDATE' : 'SAVE') | translate"
        [disabled]="!experienceForm.valid || isLoading()"
        [loading]="isLoading()"
      ></button>
    </div>
  </form>
</p-dialog>
