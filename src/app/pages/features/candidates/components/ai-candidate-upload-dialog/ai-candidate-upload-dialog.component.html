<p-dialog
  [visible]="isDialogVisible()"
  (visibleChange)="setDialogVisible($event)"
  (onHide)="onHide()"
  [style]="{ width: '60rem' }"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  class="dark:bg-slate-800 overflow-visible"
>
  <!-- [position]="'top'" -->
  <ng-template pTemplate="header">
    <div class="flex items-center gap-2">
      <i class="pi pi-sparkles text-xl text-primary"></i>
      <span class="text-base font-medium text-slate-700 dark:text-slate-200">
        {{ "GENERATE_CANDIDATE_FROM_RESUME" | translate }}
      </span>
    </div>
  </ng-template>
  <form class="space-y-4" [formGroup]="uploadForm" (ngSubmit)="onGenerate()">
    <div class="flex flex-col">
      <label
        class="flex items-center gap-2 text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"
      >
        <i class="pi pi-upload text-slate-600 dark:text-slate-400"></i>
        {{ "UPLOAD_RESUME" | translate }}
        <a
          href="#"
          class="ml-auto text-primary underline text-base hover:text-primary/80 font-semibold dark:text-secondary-foreground!"
          (click)="$event.preventDefault(); onHowItWorks()"
          >{{ "HOW_IT_WORKS" | translate }}</a
        >
      </label>
      <div
        class="w-full flex flex-col items-center justify-center border-2 border-dashed border-primary/40 rounded-lg bg-card! text-card-foreground! pt-8 min-h-[180px] cursor-pointer hover:border-primary transition"
        (drop)="onFileDrop($event)"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (click)="fileInput.click()"
      >
        <!-- [class.bg-primary/10]="dragActive" -->
        <i
          class="pi pi-cloud-upload text-4xl text-primary dark:text-white mb-2"
        ></i>
        <span class="text-sm text-text/80 mb-1">{{
          "DRAG_DROP_OR_BROWSE" | translate
        }}</span>
        <input
          #fileInput
          type="file"
          formControlName="file"
          accept=".pdf,.doc,.docx"
          class="hidden"
          (change)="onFileSelected($event)"
        />
        <div class="flex flex-col items-center w-full mt-4">
          <div
            class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"
          >
            <i class="pi pi-file-pdf text-red-500 text-base"></i>
            <span>PDF</span>
            <i class="pi pi-file-word text-blue-500 text-base ml-4"></i>
            <span>DOC, DOCX</span>
          </div>
        </div>
        <div
          *ngIf="selectedFile"
          class="flex items-center gap-2 mt-4 py-2 px-3 rounded bg-primary/10 dark:bg-primary/20 w-full"
        >
          <i class="pi pi-file text-primary dark:text-blue-200 text-xl"></i>
          <span
            class="text-base font-medium text-primary dark:text-white truncate"
            >{{ selectedFile.name }}</span
          >
          <button
            type="button"
            pButton
            icon="pi pi-times"
            class="p-button-text ml-auto"
            (click)="clearSelectedFile(); $event.stopPropagation()"
            [attr.aria-label]="'REMOVE_FILE' | translate"
          ></button>
        </div>
      </div>
    </div>
    <div class="flex justify-end gap-2 mt-6">
      <button
        pButton
        type="button"
        label="{{ 'CANCEL' | translate }}"
        icon="pi pi-times"
        class="p-button-text"
        (click)="onHide()"
        [disabled]="isLoading()"
      ></button>
      <button
        pButton
        type="submit"
        [label]="isLoading() ? 'GENERATING...' : ('GENERATE' | translate)"
        icon="pi pi-sparkles"
        [disabled]="!selectedFile || isLoading()"
        [loading]="isLoading()"
        class="bg-gradient-to-r! from-secondary! to-primary! text-white! shadow-md border-none! transition-colors duration-150 hover:opacity-90! disabled:opacity-50! disabled:cursor-not-allowed!"
      ></button>
    </div>
  </form>
</p-dialog>
