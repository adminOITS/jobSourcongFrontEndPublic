<p-dialog
  [modal]="true"
  [visible]="isVisible()"
  (visibleChange)="setIsVisible($event)"
  [closable]="true"
  [dismissableMask]="false"
  styleClass="w-[100vw]! md:w-[60vw]! xl:w-[50vw]!"
  (onHide)="hideDialog()"
  class="p-0!"
>
  <!-- [style]="{ width: '50vw' }" -->
  <ng-template pTemplate="header">
    <h2 class="text-xl font-semibold text-text!">
      {{ "EDIT_COMPANY_LOGO" | translate }}
    </h2>
  </ng-template>

  <ng-template pTemplate="content">
    <div class="p-6">
      <form [formGroup]="logoForm" (ngSubmit)="onSubmit()" class="space-y-4">
        <!-- Logo Upload Section -->
        <div>
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-image text-blue-500"></i>
            <label class="text-sm font-medium text-text/85">
              {{ "COMPANY_LOGO" | translate }}
            </label>
          </div>

          <div
            class="border-2 border-dashed border-border/50 rounded-lg p-4 text-center cursor-pointer relative transition-colors duration-300"
            [class.border-primary]="dragging"
            [class.border-green-500]="previewUrl && selectedFile"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave()"
            (drop)="onFileDropped($event)"
            (click)="fileInput.click()"
          >
            <input
              #fileInput
              type="file"
              class="hidden"
              accept="image/*"
              [multiple]="false"
              (change)="onFileSelect($event)"
            />

            <div class="flex flex-col items-center">
              <!-- Preview Area -->
              <div
                class="w-32 h-32 rounded-lg overflow-hidden bg-card/50 flex items-center justify-center mb-4 border-2 border-border/30"
              >
                @if (previewUrl) {
                <img
                  [src]="previewUrl"
                  alt="Company Logo Preview"
                  class="w-full h-full object-cover"
                />
                } @else {
                <i class="pi pi-image text-4xl text-text/30"></i>
                }
              </div>

              <!-- Upload Icon and Text -->
              <div class="flex flex-col items-center gap-2">
                <i class="pi pi-upload text-2xl text-text/60"></i>
                <p class="text-sm text-text/70">
                  {{ "DRAG_DROP_IMAGE_OR_CLICK_TO_SELECT_IMAGE" | translate }}
                </p>
                <p class="text-xs text-text/50">
                  {{ "SUPPORTED_FORMATS" | translate }}: JPG, PNG
                </p>
              </div>
            </div>
          </div>

          <!-- Clear Button -->
          @if (previewUrl && selectedFile) {
          <div class="mt-3 flex justify-center">
            <button
              type="button"
              class="flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors duration-200"
              (click)="clearLogo()"
            >
              <i class="pi pi-trash text-sm"></i>
              <span>{{ "CLEAR_LOGO" | translate }}</span>
            </button>
          </div>
          }
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-end gap-3 pt-4">
          <button
            type="button"
            pButton
            class="p-button-outlined p-button-secondary"
            (click)="hideDialog()"
            [disabled]="isLoading()"
          >
            {{ "CANCEL" | translate }}
          </button>

          <button
            type="submit"
            pButton
            class="p-button-primary"
            [disabled]="!selectedFile || isLoading()"
            [loading]="isLoading()"
          >
            {{ "UPDATE_LOGO" | translate }}
          </button>
        </div>
      </form>
    </div>
  </ng-template>
</p-dialog>
