<div class="card">
  <form
    [formGroup]="companyForm"
    (ngSubmit)="onSubmit()"
    class="text-card-foreground! bg-card space-y-3 mx-auto"
    autocomplete="off"
  >
    <!-- Step 1: Company Information -->
    <div *ngIf="currentStep === 1">
      <div class="grid gap-4 grid-cols-1 lg:grid-cols-2 w-full">
        <!-- Image Upload -->
        <div class="col-span-2">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-image text-blue-500"></i>
            <label class="text-sm font-medium text-text/85">{{
              "COMPANY_LOGO" | translate
            }}</label>
          </div>
          <div
            class="border-2 border-dashed border-border/50 rounded-lg p-6 text-center cursor-pointer relative"
            [class.border-primary]="dragging"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave()"
            (drop)="onFileDropped($event)"
            (click)="fileInput.click()"
          >
            <input
              #fileInput
              type="file"
              class="hidden"
              accept="image/*"
              (change)="onFileSelect($event)"
              formControlName="logo"
            />
            <div class="flex flex-col items-center">
              <div
                class="w-25 h-25 rounded-md overflow-hidden bg-card/50 flex items-center justify-center mb-3"
              >
                <img
                  *ngIf="previewUrl"
                  [src]="previewUrl"
                  alt="Company Logo Preview"
                  class="w-full h-full object-cover"
                />
                <i
                  *ngIf="!previewUrl"
                  class="pi pi-image text-3xl text-text/30"
                ></i>
              </div>
              <i class="pi pi-upload text-2xl mb-2"></i>
              <p class="text-sm text-text/70">
                {{ "DRAG_DROP_IMAGE_OR_CLICK_TO_SELECT_IMAGE" | translate }}
              </p>
            </div>
          </div>
        </div>

        <!-- First Section -->
        <div class="col-span-2 grid gap-4 lg:grid-cols-2 grid-cols-1">
          <!-- Company Name -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-building text-blue-500"></i>
              <label for="name" class="text-sm font-medium text-text/85"
                >{{ "COMPANY_NAME" | translate }} *</label
              >
            </div>
            <input
              id="name"
              type="text"
              pInputText
              formControlName="name"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('name')?.invalid &&
                companyForm.get('name')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span *ngIf="companyForm.get('name')?.errors?.['required']">{{
                "COMPANY_NAME_REQUIRED" | translate
              }}</span>
            </div>
          </div>

          <!-- Contact -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-phone text-orange-500"></i>
              <label for="contact" class="text-sm font-medium text-text/85"
                >{{ "CONTACT_PERSON" | translate }} *</label
              >
            </div>
            <input
              id="contact"
              type="text"
              pInputText
              formControlName="contact"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('contact')?.invalid &&
                companyForm.get('contact')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span *ngIf="companyForm.get('contact')?.errors?.['required']">{{
                "CONTACT_PERSON_REQUIRED" | translate
              }}</span>
            </div>
          </div>

          <!-- Email -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-envelope text-red-500"></i>
              <label for="email" class="text-sm font-medium text-text/85"
                >{{ "EMAIL" | translate }} *</label
              >
            </div>
            <input
              id="email"
              type="email"
              pInputText
              formControlName="email"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('email')?.invalid &&
                companyForm.get('email')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span *ngIf="companyForm.get('email')?.errors?.['required']">{{
                "EMAIL_REQUIRED" | translate
              }}</span>
              <span *ngIf="companyForm.get('email')?.errors?.['email']">{{
                "EMAIL_INVALID" | translate
              }}</span>
            </div>
          </div>

          <!-- Website Link -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-link text-cyan-500"></i>
              <label
                for="webSiteLink"
                class="text-sm font-medium text-text/85"
                >{{ "WEBSITE" | translate }}</label
              >
            </div>
            <input
              id="webSiteLink"
              type="text"
              pInputText
              formControlName="webSiteLink"
              placeholder="https://www.example.com"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('webSiteLink')?.invalid &&
                companyForm.get('webSiteLink')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span
                *ngIf="companyForm.get('webSiteLink')?.errors?.['pattern']"
                >{{ "WEBSITE_INVALID" | translate }}</span
              >
            </div>
          </div>

          <!-- Sector -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-briefcase text-indigo-500"></i>
              <label for="sector" class="text-sm font-medium text-text/85"
                >{{ "SECTOR" | translate }} *</label
              >
            </div>
            <input
              id="sector"
              type="text"
              pInputText
              formControlName="sector"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('sector')?.invalid &&
                companyForm.get('sector')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span *ngIf="companyForm.get('sector')?.errors?.['required']">{{
                "SECTOR_REQUIRED" | translate
              }}</span>
            </div>
          </div>

          <!-- Founded Year -->
          <div class="flex flex-col w-full">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-calendar text-yellow-500"></i>
              <label
                for="foundedYear"
                class="text-sm font-medium text-text/85"
                >{{ "FOUNDED_YEAR" | translate }}</label
              >
            </div>
            <p-datepicker
              formControlName="foundedYear"
              id="foundedYear"
              iconDisplay="input"
              showIcon
              size="small"
              view="year"
              dateFormat="yy"
              styleClass="w-full"
              [maxDate]="maxDate"
            />
          </div>
        </div>

        <!-- Colors -->
        <div class="flex gap-4 items-center lg:col-span-1 col-span-2 w-full">
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-palette text-pink-500"></i>
              <label
                for="primaryColor"
                class="text-sm font-medium text-text/85"
                >{{ "PRIMARY_COLOR" | translate }}</label
              >
            </div>
            <p-colorpicker formControlName="primaryColor" inputId="cp-hex" />
          </div>
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-palette text-pink-500"></i>
              <label
                for="secondaryColor"
                class="text-sm font-medium text-text/85"
                >{{ "SECONDARY_COLOR" | translate }}</label
              >
            </div>
            <p-colorpicker formControlName="secondaryColor" inputId="cp-hex" />
          </div>
        </div>
        <div class="flex flex-col md:col-span-1 col-span-2 w-full">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-users text-green-500"></i>
            <label for="companySize" class="text-sm font-medium text-text/85">{{
              "COMPANY_SIZE" | translate
            }}</label>
          </div>
          <p-select
            id="companySize"
            [options]="companySizeOptions"
            optionLabel="name"
            optionValue="value"
            placeholder="{{ 'SELECT_COMPANY_SIZE' | translate }}"
            formControlName="companySize"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
            styleClass="small-select"
          >
          </p-select>
        </div>

        <!-- Address Group -->
        <div
          formGroupName="address"
          class="col-span-2 grid gap-4 grid-cols-1 lg:grid-cols-2"
        >
          <!-- Address Line 1 -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-map-marker text-green-500"></i>
              <label for="addressLine1" class="text-sm font-medium text-text/85"
                >{{ "ADDRESS_LINE_1" | translate }} *</label
              >
            </div>
            <input
              id="addressLine1"
              type="text"
              pInputText
              formControlName="addressLine1"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('address.addressLine1')?.invalid &&
                companyForm.get('address.addressLine1')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span
                *ngIf="companyForm.get('address.addressLine1')?.errors?.['required']"
                >{{ "ADDRESS_LINE_1_REQUIRED" | translate }}</span
              >
            </div>
          </div>

          <!-- Address Line 2 -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-map-marker text-green-500"></i>
              <label
                for="addressLine2"
                class="text-sm font-medium text-text/85"
                >{{ "ADDRESS_LINE_2" | translate }}</label
              >
            </div>
            <input
              id="addressLine2"
              type="text"
              pInputText
              formControlName="addressLine2"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
          </div>

          <!-- City -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-map text-green-500"></i>
              <label for="city" class="text-sm font-medium text-text/85"
                >{{ "CITY" | translate }} *</label
              >
            </div>
            <input
              id="city"
              type="text"
              pInputText
              formControlName="city"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('address.city')?.invalid &&
                companyForm.get('address.city')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span
                *ngIf="companyForm.get('address.city')?.errors?.['required']"
                >{{ "CITY_REQUIRED" | translate }}</span
              >
            </div>
          </div>

          <!-- Zip Code -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-map-marker text-green-500"></i>
              <label for="zipCode" class="text-sm font-medium text-text/85"
                >{{ "ZIP_CODE" | translate }} *</label
              >
            </div>
            <input
              id="zipCode"
              type="text"
              pInputText
              formControlName="zipCode"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('address.zipCode')?.invalid &&
                companyForm.get('address.zipCode')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span
                *ngIf="companyForm.get('address.zipCode')?.errors?.['required']"
                >{{ "ZIP_CODE_REQUIRED" | translate }}</span
              >
            </div>
          </div>

          <!-- Country -->
          <div class="flex flex-col">
            <div class="flex items-center gap-2 mb-1">
              <i class="pi pi-globe text-purple-500"></i>
              <label for="country" class="text-sm font-medium text-text/85"
                >{{ "COUNTRY" | translate }} *</label
              >
            </div>
            <input
              id="country"
              type="text"
              pInputText
              formControlName="country"
              class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
              pSize="small"
            />
            <div
              *ngIf="
                companyForm.get('address.country')?.invalid &&
                companyForm.get('address.country')?.touched
              "
              class="text-red-500 text-xs mt-1"
            >
              <span
                *ngIf="companyForm.get('address.country')?.errors?.['required']"
                >{{ "COUNTRY_REQUIRED" | translate }}</span
              >
            </div>
          </div>
        </div>

        <!-- Description -->
        <div class="col-span-2 flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-info-circle text-teal-500"></i>
            <label for="description" class="text-sm font-medium text-text/85">{{
              "DESCRIPTION" | translate
            }}</label>
          </div>
          <textarea
            pTextarea
            id="description"
            formControlName="description"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
            rows="5"
            [autoResize]="true"
          ></textarea>
        </div>
      </div>

      <!-- Next Button -->
      <div class="flex justify-end mt-6">
        <button
          type="button"
          pButton
          [label]="'NEXT' | translate"
          (click)="nextStep()"
          [disabled]="!isCompanyFormValid()"
        ></button>
      </div>
    </div>

    <!-- Step 2: HR Information -->
    <div *ngIf="currentStep === 2">
      <div class="grid gap-4 grid-cols-1 lg:grid-cols-2 w-full">
        <!-- First Name -->
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-user text-blue-500"></i>
            <label for="firstName" class="text-sm font-medium text-text/85"
              >{{ "FIRST_NAME" | translate }} *</label
            >
          </div>
          <input
            id="firstName"
            type="text"
            pInputText
            formControlName="firstName"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
          />
          <div
            *ngIf="
              companyForm.get('firstName')?.invalid &&
              companyForm.get('firstName')?.touched
            "
            class="text-red-500 text-xs mt-1"
          >
            <span *ngIf="companyForm.get('firstName')?.errors?.['required']">{{
              "FIRST_NAME_REQUIRED" | translate
            }}</span>
          </div>
        </div>

        <!-- Last Name -->
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-user text-blue-500"></i>
            <label for="lastName" class="text-sm font-medium text-text/85"
              >{{ "LAST_NAME" | translate }} *</label
            >
          </div>
          <input
            id="lastName"
            type="text"
            pInputText
            formControlName="lastName"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
          />
          <div
            *ngIf="
              companyForm.get('lastName')?.invalid &&
              companyForm.get('lastName')?.touched
            "
            class="text-red-500 text-xs mt-1"
          >
            <span *ngIf="companyForm.get('lastName')?.errors?.['required']">{{
              "LAST_NAME_REQUIRED" | translate
            }}</span>
          </div>
        </div>

        <!-- Phone -->
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-phone text-orange-500"></i>
            <label for="phone" class="text-sm font-medium text-text/85"
              >{{ "PHONE" | translate }} *</label
            >
          </div>
          <input
            id="phone"
            type="tel"
            pInputText
            formControlName="phone"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
          />
          <div
            *ngIf="
              companyForm.get('phone')?.invalid &&
              companyForm.get('phone')?.touched
            "
            class="text-red-500 text-xs mt-1"
          >
            <span *ngIf="companyForm.get('phone')?.errors?.['required']">{{
              "PHONE_REQUIRED" | translate
            }}</span>
          </div>
        </div>

        <!-- City -->
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-map text-green-500"></i>
            <label for="city" class="text-sm font-medium text-text/85"
              >{{ "CITY" | translate }} *</label
            >
          </div>
          <input
            id="city"
            type="text"
            pInputText
            formControlName="city"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
          />
          <div
            *ngIf="
              companyForm.get('city')?.invalid &&
              companyForm.get('city')?.touched
            "
            class="text-red-500 text-xs mt-1"
          >
            <span *ngIf="companyForm.get('city')?.errors?.['required']">{{
              "CITY_REQUIRED" | translate
            }}</span>
          </div>
        </div>

        <!-- Country -->
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-globe text-purple-500"></i>
            <label for="hrCountry" class="text-sm font-medium text-text/85"
              >{{ "COUNTRY" | translate }} *</label
            >
          </div>
          <input
            id="hrCountry"
            type="text"
            pInputText
            formControlName="hrCountry"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
          />
          <div
            *ngIf="
              companyForm.get('hrCountry')?.invalid &&
              companyForm.get('hrCountry')?.touched
            "
            class="text-red-500 text-xs mt-1"
          >
            <span *ngIf="companyForm.get('hrCountry')?.errors?.['required']">{{
              "COUNTRY_REQUIRED" | translate
            }}</span>
          </div>
        </div>

        <!-- Email -->
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-1">
            <i class="pi pi-envelope text-red-500"></i>
            <label for="hrEmail" class="text-sm font-medium text-text/85"
              >{{ "EMAIL" | translate }} *</label
            >
          </div>
          <input
            id="hrEmail"
            type="email"
            pInputText
            formControlName="hrEmail"
            class="w-full rounded-md! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
            pSize="small"
          />
          <div
            *ngIf="
              companyForm.get('hrEmail')?.invalid &&
              companyForm.get('hrEmail')?.touched
            "
            class="text-red-500 text-xs mt-1"
          >
            <span *ngIf="companyForm.get('hrEmail')?.errors?.['required']">{{
              "EMAIL_REQUIRED" | translate
            }}</span>
            <span *ngIf="companyForm.get('hrEmail')?.errors?.['email']">{{
              "EMAIL_INVALID" | translate
            }}</span>
          </div>
        </div>
      </div>

      <!-- Navigation Buttons -->
      <div class="flex justify-end gap-2 mt-6">
        <button
          type="button"
          pButton
          label="Back"
          class="p-button-text"
          (click)="previousStep()"
          [disabled]="isLoading()"
        ></button>
        <button
          type="submit"
          pButton
          label="Submit"
          [disabled]="!companyForm.valid || isLoading()"
          [loading]="isLoading()"
        ></button>
      </div>
    </div>
  </form>
</div>
