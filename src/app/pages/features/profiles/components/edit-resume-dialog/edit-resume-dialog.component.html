<p-dialog
  [modal]="true"
  [visible]="isDialogVisible()"
  (visibleChange)="setIsDialogVisible($event)"
  [closable]="true"
  [dismissableMask]="false"
  [breakpoints]="{ '1199px': '60vw', '640px': '100vw' }"
  [style]="{ width: '60vw' }"
  [draggable]="false"
  [resizable]="false"
  (onHide)="closeDialog()"
  styleClass="overflow-visible"
>
  <ng-template pTemplate="header">
    <h2 class="text-xl font-semibold text-gray-800 dark:text-white">
      {{ "EDIT_RESUME" | translate }}
    </h2>
  </ng-template>
  <ng-template pTemplate="content">
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="space-y-6">
      <!-- Resume Upload Only -->
      <div class="field">
        <label class="block text-sm font-medium text-text mb-2">
          {{ "RESUME" | translate }}
        </label>
        <div
          class="w-full flex flex-col items-center justify-center border-2 border-dashed border-primary/40 dark:border-gray-500 rounded-lg bg-card! text-card-foreground! pt-8 min-h-[180px] cursor-pointer hover:border-primary transition"
          (drop)="onFileDrop($event)"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          (click)="fileInput.click()"
          [class.border-red-500]="
            profileForm.get('resumeFile')?.invalid &&
            profileForm.get('resumeFile')?.touched
          "
        >
          <i
            class="pi pi-cloud-upload text-4xl text-primary dark:text-white mb-2"
          ></i>
          <span class="text-sm text-text/80 mb-1">{{
            "DRAG_DROP_OR_BROWSE" | translate
          }}</span>
          <input
            #fileInput
            type="file"
            accept=".pdf,.doc,.docx"
            class="hidden"
            (change)="onFileSelected($event)"
          />
          <div class="flex flex-col items-center w-full mt-4">
            <div
              class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"
            >
              <i class="pi pi-file-pdf text-red-500 text-base"></i>
              <span>PDF</span>
              <i class="pi pi-file-word text-blue-500 text-base ml-4"></i>
              <span>DOC, DOCX</span>
            </div>
          </div>
          <div
            *ngIf="selectedFile"
            class="flex items-center gap-2 mt-4 py-2 px-3 rounded bg-primary/10 dark:bg-primary/20 w-full"
          >
            <i class="pi pi-file text-primary dark:text-blue-200 text-xl"></i>
            <span
              class="text-base font-medium text-primary dark:text-white truncate"
              >{{ selectedFile.name }}</span
            >
            <button
              type="button"
              pButton
              icon="pi pi-times"
              class="p-button-text ml-auto"
              (click)="clearSelectedFile(); $event.stopPropagation()"
              [attr.aria-label]="'REMOVE_FILE' | translate"
            ></button>
          </div>
        </div>
        <small
          *ngIf="
            profileForm.get('resumeFile')?.invalid &&
            profileForm.get('resumeFile')?.touched
          "
          class="p-error block mt-1 dark:text-red-400! text-red-500!"
        >
          {{ "RESUME_IS_REQUIRED" | translate }}
        </small>
      </div>
      <!-- Submit Button -->
      <div class="flex justify-end">
        <button
          pButton
          type="submit"
          [loading]="isLoading()"
          label="{{ 'SAVE_PROFILE' | translate }}"
          class="p-button-primary"
          [disabled]="profileForm.invalid || isLoading()"
        ></button>
      </div>
    </form>
  </ng-template>
</p-dialog>
