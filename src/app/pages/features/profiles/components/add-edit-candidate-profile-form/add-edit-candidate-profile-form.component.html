<form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="space-y-6">
  <!-- Title and Category on the same line for big screens -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Title Input -->
    <div class="field">
      <label for="title" class="block text-sm font-medium text-text mb-2">
        {{ "TITLE" | translate }}<span class="text-red-500 ml-1">*</span>
      </label>
      <input
        id="title"
        type="text"
        pInputText
        formControlName="title"
        class="w-full rounded-md! bg-card! text-card-foreground! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
        [ngClass]="{
          'p-invalid':
            profileForm.get('title')?.invalid &&
            profileForm.get('title')?.touched
        }"
      />
      <small
        *ngIf="
          profileForm.get('title')?.invalid && profileForm.get('title')?.touched
        "
        class="p-error block mt-1 dark:text-red-400! text-red-500!"
      >
        <span *ngIf="profileForm.get('title')?.errors?.['required']">{{
          "PROFILE_TITLE_IS_REQUIRED" | translate
        }}</span>
        <span *ngIf="profileForm.get('title')?.errors?.['minlength']">{{
          "PROFILE_TITLE_MUST_BE_AT_LEAST_3_CHARACTERS" | translate
        }}</span>
      </small>
    </div>

    <!-- Category Select -->
    <div class="field">
      <label for="category" class="block text-sm font-medium text-text mb-2">
        {{ "CATEGORY" | translate }}<span class="text-red-500 ml-1">*</span>
      </label>
      <p-select
        inputId="category"
        formControlName="category"
        [options]="jobCategories"
        [showClear]="true"
        [filter]="true"
        [filterPlaceholder]="'SEARCH_CATEGORY' | translate"
        optionLabel="name"
        optionValue="value"
        class="w-full rounded-md! py-0! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary!"
      ></p-select>
      <small
        *ngIf="
          profileForm.get('category')?.invalid &&
          profileForm.get('category')?.touched
        "
        class="p-error block mt-1 dark:text-red-400! text-red-500!"
      >
        {{ "CATEGORY_IS_REQUIRED" | translate }}
      </small>
    </div>
  </div>

  <!-- Resume Upload -->
  <div class="field">
    <label class="block text-sm font-medium text-text mb-2">
      {{ "RESUME" | translate }}
      <!-- <span class="text-red-500 ml-1">*</span> -->
    </label>
    <div
      class="w-full flex flex-col items-center justify-center border-2 border-dashed border-primary/40 dark:border-gray-500 rounded-lg bg-card! text-card-foreground! pt-8 min-h-[180px] cursor-pointer hover:border-primary transition"
      (drop)="onFileDrop($event)"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (click)="fileInput.click()"
      [class.border-red-500]="
        profileForm.get('resumeFile')?.invalid &&
        profileForm.get('resumeFile')?.touched
      "
    >
      <i
        class="pi pi-cloud-upload text-4xl text-primary dark:text-white mb-2"
      ></i>
      <span class="text-sm text-text/80 mb-1">{{
        "DRAG_DROP_OR_BROWSE" | translate
      }}</span>
      <input
        #fileInput
        type="file"
        accept=".pdf,.doc,.docx"
        class="hidden"
        (change)="onFileSelected($event)"
      />
      <div class="flex flex-col items-center w-full mt-4">
        <div
          class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"
        >
          <i class="pi pi-file-pdf text-red-500 text-base"></i>
          <span>PDF</span>
          <i class="pi pi-file-word text-blue-500 text-base ml-4"></i>
          <span>DOC, DOCX</span>
        </div>
      </div>
      <div
        *ngIf="selectedFile"
        class="flex items-center gap-2 mt-4 py-2 px-3 rounded bg-primary/10 dark:bg-primary/20 w-full"
      >
        <i class="pi pi-file text-primary dark:text-blue-200 text-xl"></i>
        <span
          class="text-base font-medium text-primary dark:text-white truncate"
          >{{ selectedFile.name }}</span
        >
        <button
          type="button"
          pButton
          icon="pi pi-times"
          class="p-button-text ml-auto"
          (click)="clearSelectedFile(); $event.stopPropagation()"
          [attr.aria-label]="'REMOVE_FILE' | translate"
        ></button>
      </div>
    </div>
    <small
      *ngIf="
        profileForm.get('resumeFile')?.invalid &&
        profileForm.get('resumeFile')?.touched
      "
      class="p-error block mt-1 dark:text-red-400! text-red-500!"
    >
      {{ "RESUME_IS_REQUIRED" | translate }}
    </small>
  </div>

  <!-- Skills MultiSelect on separate line -->
  <div class="field">
    <label for="skills" class="block text-sm font-medium text-text mb-2">
      {{ "SKILLS" | translate }}<span class="text-red-500 ml-1">*</span>
    </label>
    <p-multiSelect
      id="skills"
      [options]="skillsOptions"
      formControlName="skills"
      optionLabel="name"
      optionValue="value"
      placeholder="Select skills"
      class="w-full rounded-md! py-0! bg-card! text-text! hover:border-primary! focus:border-primary! focus:ring-primary! dark:hover:border-white! dark:focus:border-white! dark:focus:ring-white!"
      pSize="small"
      [ngClass]="{
        'p-invalid':
          profileForm.get('skills')?.invalid &&
          profileForm.get('skills')?.touched
      }"
    ></p-multiSelect>
    <small
      *ngIf="
        profileForm.get('skills')?.invalid && profileForm.get('skills')?.touched
      "
      class="p-error block mt-1 text-red-500 dark:text-red-400"
    >
      {{ "AT_LEAST_ONE_SKILL_IS_REQUIRED" | translate }}
    </small>
  </div>

  <!-- Submit Button -->
  <div class="flex justify-end">
    <button
      pButton
      type="submit"
      [loading]="isLoading()"
      label="{{ 'SAVE_PROFILE' | translate }}"
      class="p-button-primary"
      [disabled]="profileForm.invalid || isLoading()"
    ></button>
  </div>
</form>
